{"remainingRequest":"/Users/admin/Desktop/ALICK_SOMAN_P7OPC/groupomania-réseau-social/node_modules/babel-loader/lib/index.js!/Users/admin/Desktop/ALICK_SOMAN_P7OPC/groupomania-réseau-social/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/admin/Desktop/ALICK_SOMAN_P7OPC/groupomania-réseau-social/node_modules/vue-loader-v16/dist/index.js??ref--0-1!/Users/admin/Desktop/ALICK_SOMAN_P7OPC/groupomania-réseau-social/src/components/ModifyPost.vue?vue&type=script&lang=js","dependencies":[{"path":"/Users/admin/Desktop/ALICK_SOMAN_P7OPC/groupomania-réseau-social/src/components/ModifyPost.vue","mtime":1648213430815},{"path":"/Users/admin/Desktop/ALICK_SOMAN_P7OPC/groupomania-réseau-social/node_modules/cache-loader/dist/cjs.js","mtime":1646670308046},{"path":"/Users/admin/Desktop/ALICK_SOMAN_P7OPC/groupomania-réseau-social/node_modules/babel-loader/lib/index.js","mtime":1646670309179},{"path":"/Users/admin/Desktop/ALICK_SOMAN_P7OPC/groupomania-réseau-social/node_modules/cache-loader/dist/cjs.js","mtime":1646670308046},{"path":"/Users/admin/Desktop/ALICK_SOMAN_P7OPC/groupomania-réseau-social/node_modules/vue-loader-v16/dist/index.js","mtime":1646670309571}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9hc3luY1RvR2VuZXJhdG9yIGZyb20gIi9Vc2Vycy9hZG1pbi9EZXNrdG9wL0FMSUNLX1NPTUFOX1A3T1BDL2dyb3Vwb21hbmlhLXJceEU5c2VhdS1zb2NpYWwvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL2FzeW5jVG9HZW5lcmF0b3IiOwppbXBvcnQgX29iamVjdFNwcmVhZCBmcm9tICIvVXNlcnMvYWRtaW4vRGVza3RvcC9BTElDS19TT01BTl9QN09QQy9ncm91cG9tYW5pYS1yXHhFOXNlYXUtc29jaWFsL25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9vYmplY3RTcHJlYWQyIjsKaW1wb3J0ICJyZWdlbmVyYXRvci1ydW50aW1lL3J1bnRpbWUuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5vYmplY3QudG8tc3RyaW5nLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuc3RyaW5nLml0ZXJhdG9yLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvd2ViLmRvbS1jb2xsZWN0aW9ucy5pdGVyYXRvci5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL3dlYi51cmwuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5yZWdleHAuZXhlYy5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnN0cmluZy5zcGxpdC5qcyI7CmltcG9ydCBheGlvcyBmcm9tICdheGlvcyc7CmltcG9ydCByb3V0ZXIgZnJvbSAnLi4vcm91dGVyJzsKZXhwb3J0IGRlZmF1bHQgewogIG5hbWU6ICdNb2RpZnlQb3N0JywKICBiZWZvcmVDcmVhdGU6IGZ1bmN0aW9uIGJlZm9yZUNyZWF0ZSgpIHsKICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgLyogb24gcsOpY3Vww6hyZSBsJ2lkIGR1IHBvc3QgdmlhIGwndXJsICovCiAgICB2YXIgcGFyc2VkVXJsID0gbmV3IFVSTCh3aW5kb3cubG9jYXRpb24uaHJlZik7CiAgICB2YXIgcG9zdElkID0gcGFyc2VkVXJsLnBhdGhuYW1lLnNwbGl0KCcvbW9kaWZ5LXBvc3QvJylbMV07CiAgICAvKiBzZWxvbiBsJ2lkIG9uIHLDqWN1cMOocmUgbGUgcG9zdCBjb25jZXJuw6kgKi8KCiAgICBmZXRjaCgiaHR0cDovL2xvY2FsaG9zdDozMDAwL2FwaS9wb3N0cy8iLmNvbmNhdChwb3N0SWQpLCB7CiAgICAgIGhlYWRlcnM6IHsKICAgICAgICBBdXRob3JpemF0aW9uOiAiQmVhcmVyICIuY29uY2F0KGxvY2FsU3RvcmFnZS5nZXRJdGVtKCd0b2tlbicpKQogICAgICB9CiAgICB9KS50aGVuKGZ1bmN0aW9uIChyZXMpIHsKICAgICAgcmV0dXJuIHJlcy5qc29uKCk7CiAgICB9KS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7CiAgICAgIGRhdGEuZmlsZSA/IF90aGlzLnByZXZpZXcgPSB0cnVlIDogX3RoaXMucHJldmlldyA9IGZhbHNlOwogICAgICBfdGhpcy5wb3N0ID0gX29iamVjdFNwcmVhZCh7fSwgZGF0YSk7CiAgICB9KS5jYXRjaChmdW5jdGlvbiAoZXJyb3IpIHsKICAgICAgZXJyb3I7CiAgICB9KTsKICB9LAogIGRhdGE6IGZ1bmN0aW9uIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICBwb3N0OiB7fSwKICAgICAgbmV3RmlsZTogJycsCiAgICAgIHByZXZpZXc6IG51bGwsCiAgICAgIGVyck1zZzogbnVsbAogICAgfTsKICB9LAogIG1ldGhvZHM6IHsKICAgIHVwZGF0ZUZpbGU6IGZ1bmN0aW9uIHVwZGF0ZUZpbGUoZXZlbnQpIHsKICAgICAgLyogc3VyIGxlIG9uY2hhbmdlIG9uIHZhIGF0dHJpYnVlciBjZXR0ZSB2YWxldXIgw6AgZmlsZSAobsOpY2Vzc2FpcmUgcG91ciBsJ2Vudm9pIGF1IGJhY2tlbmQpICovCiAgICAgIHRoaXMubmV3RmlsZSA9IHRoaXMuJHJlZnMuZmlsZS5maWxlc1swXTsKICAgICAgdmFyIGlucHV0ID0gZXZlbnQudGFyZ2V0OwoKICAgICAgaWYgKGlucHV0LmZpbGVzKSB7CiAgICAgICAgdmFyIHJlYWRlciA9IG5ldyBGaWxlUmVhZGVyKCk7CgogICAgICAgIHJlYWRlci5vbmxvYWQgPSBmdW5jdGlvbiAoZSkgewogICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3ByZXZpZXcnKS5zcmMgPSBlLnRhcmdldC5yZXN1bHQ7CiAgICAgICAgfTsKCiAgICAgICAgcmVhZGVyLnJlYWRBc0RhdGFVUkwoaW5wdXQuZmlsZXNbMF0pOwogICAgICAgIHRoaXMucHJldmlldyA9IHRydWU7CiAgICAgIH0KICAgIH0sCiAgICBtb2RpZnlQb3N0OiBmdW5jdGlvbiBtb2RpZnlQb3N0KCkgewogICAgICB2YXIgX3RoaXMyID0gdGhpczsKCiAgICAgIHJldHVybiBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUoKSB7CiAgICAgICAgdmFyIGZvcm1EYXRhOwogICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlJChfY29udGV4dCkgewogICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dC5wcmV2ID0gX2NvbnRleHQubmV4dCkgewogICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgIGlmIChfdGhpczIucG9zdC50KSB7CiAgICAgICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSAzOwogICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBfdGhpczIuZXJyTXNnID0gIkVycm9yID0+IHZvdXMgZGV2ZXogcmVtcGxpciBsZSBjaGFtcCA8bWVzc2FnZT4gcG91ciBjcsOpZXIgdW5lIG5vdXZlbGxlIHB1YmxpY2F0aW9uISI7CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuYWJydXB0KCJyZXR1cm4iKTsKCiAgICAgICAgICAgICAgY2FzZSAzOgogICAgICAgICAgICAgICAgLyogb24gY3LDqcOpIHVuIG9iamV0IGZvcm1EYXRhIGFmaW4gZGUgcG91dm9pciBham91dGVyIGxlIHRleHRlIGV0IHN1cnRvdXQgbGUgZmlsZSBjaG9pc2kgKi8KICAgICAgICAgICAgICAgIGZvcm1EYXRhID0gbmV3IEZvcm1EYXRhKCk7CiAgICAgICAgICAgICAgICBmb3JtRGF0YS5hcHBlbmQoJ3RpdGxlJywgX3RoaXMyLnBvc3QudGl0bGUpOwogICAgICAgICAgICAgICAgZm9ybURhdGEuYXBwZW5kKCd0ZXh0JywgX3RoaXMyLnBvc3QudGV4dCk7CgogICAgICAgICAgICAgICAgaWYgKF90aGlzMi5uZXdGaWxlKSB7CiAgICAgICAgICAgICAgICAgIGZvcm1EYXRhLmFwcGVuZCgnZmlsZScsIF90aGlzMi5uZXdGaWxlKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIC8qIGVudm9pIGR1IGZvcm0gdmlhIGF4aW9zLnB1dCBkZSBsJ29iamV0IGZvcm1EYXRhICovCgoKICAgICAgICAgICAgICAgIGlmIChjb25maXJtKCJNb2RpZmllciB2b3RyZSBwb3N0ID8iKSkgewogICAgICAgICAgICAgICAgICBheGlvcy5wdXQoImh0dHA6Ly9sb2NhbGhvc3Q6MzAwMC9hcGkvcG9zdHMvIi5jb25jYXQoX3RoaXMyLnBvc3QuaWQpLCBmb3JtRGF0YSwgewogICAgICAgICAgICAgICAgICAgIGhlYWRlcnM6IHsKICAgICAgICAgICAgICAgICAgICAgIEF1dGhvcml6YXRpb246ICJCZWFyZXIgIi5jb25jYXQobG9jYWxTdG9yYWdlLmdldEl0ZW0oJ3Rva2VuJykpCiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICB9KS50aGVuKGZ1bmN0aW9uIChyZXMpIHsKICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhyZXMuZGF0YSk7CiAgICAgICAgICAgICAgICAgICAgcm91dGVyLnB1c2goewogICAgICAgICAgICAgICAgICAgICAgcGF0aDogJy9ob21lJwogICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICB9KS5jYXRjaChmdW5jdGlvbiAoZXJyb3IpIHsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gY29uc29sZS5sb2coZXJyb3IpOwogICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgY2FzZSA4OgogICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuc3RvcCgpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSwgX2NhbGxlZSk7CiAgICAgIH0pKSgpOwogICAgfQogIH0KfTs="},{"version":3,"sources":["/Users/admin/Desktop/ALICK_SOMAN_P7OPC/groupomania-réseau-social/src/components/ModifyPost.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\n    <div id=\"modifyPost\">\n        <form @submit.prevent=\"modifyPost\">\n            <div id=\"text\">\n                <label for=\"textarea\">Modifier le titre</label>\n            <input name=\"input\" v-model=\"post.title\">\n            </div> \n            <div id=\"text\">\n                <label for=\"textarea\">Modifier le commentaire</label>\n                <textarea name=\"textarea\" v-model=\"post.text\"></textarea>\n            </div>\n            <div id=\"modify\">\n                <input type=\"submit\" value=\"je modifie !\" class=\"btn\">    \n            </div>\n            <div id=\"btns\">\n                <label for=\"file\">Choisir une nouvelle image</label>\n                <input type=\"file\" ref=\"file\" name=\"file\" class=\"upload\" id=\"file\" @change=\"updateFile\">\n            </div>\n            <div id=\"fileContainer\">\n                <img id=\"preview\" :src=\"'http://localhost:3000/images/' + post.file\" :alt=\"post.file\" v-if=\"preview\">\n                <p v-else>Ce post ne possède pas d'image</p>\n            </div>\n\n            <p>{{errMsg}}</p>\n        </form>\n    </div>\n</template>\n\n<script>\nimport axios from 'axios';\nimport router from '../router'\nexport default {\n    name: 'ModifyPost',\n    beforeCreate() {\n        /* on récupère l'id du post via l'url */\n        const parsedUrl = new URL(window.location.href)\n        const postId = parsedUrl.pathname.split('/modify-post/')[1]\n        /* selon l'id on récupère le post concerné */\n        fetch(`http://localhost:3000/api/posts/${postId}`, {\n            headers: {\n                Authorization: `Bearer ${localStorage.getItem('token')}`\n            }\n        })\n            .then(res => res.json())\n            .then(data => {\n                data.file ? this.preview = true : this.preview = false\n                this.post = {...data}\n            })\n            .catch(error => {error})\n    },\n    data() {\n        return {\n            post: {},\n            newFile: '',\n            preview: null,\n            errMsg: null\n        }\n    },\n    methods: {\n        updateFile(event) {\n            /* sur le onchange on va attribuer cette valeur à file (nécessaire pour l'envoi au backend) */ \n            this.newFile = this.$refs.file.files[0]\n            let input = event.target\n            if(input.files) {\n                let reader = new FileReader()\n                reader.onload = (e) => {\n                    document.getElementById('preview').src = e.target.result\n                }\n                reader.readAsDataURL(input.files[0])\n                this.preview = true\n            }\n        },\n        async modifyPost() {\n            /* on peut envoyer un post sans image mais il faut au moins qu'il y est un texte */     \n            if (!this.post.t) {\n                this.errMsg = \"Error => vous devez remplir le champ <message> pour créer une nouvelle publication!\"\n                return\n            }\n            /* on créé un objet formData afin de pouvoir ajouter le texte et surtout le file choisi */\n            let formData = new FormData()\n            formData.append('title', this.post.title)\n            formData.append('text', this.post.text)\n            if (this.newFile) {\n                formData.append('file', this.newFile)\n            }\n            /* envoi du form via axios.put de l'objet formData */\n            if (confirm(\"Modifier votre post ?\")) {\n                axios.put(`http://localhost:3000/api/posts/${this.post.id}`, formData, {\n                    headers: {\n                        Authorization: `Bearer ${localStorage.getItem('token')}`\n                    },\n                })  \n                    .then(res => {\n                        console.log(res.data)\n                        router.push({ path: '/home' })                                               \n                    })\n                    .catch(error => console.log(error))\n            }            \n        }\n    }\n}\n</script>\n\n<style scoped>\n#modifyPost {\n    max-width: 60%;\n    box-shadow: 2px 2px 8px 5px rgb(0 0 0 / 10%);\n    margin: auto;\n    margin-top: 2rem;\n    padding: 1rem;\n    border-radius: 4px;\n}\nform {\n    display: flex;\n    flex-direction: column;\n}\n#fileContainer {\n    overflow: hidden;\n    margin: 1rem 0 1rem 0;\n}\nimg {\n    height: 100%;\n    width: 100%;\n    object-fit: cover;\n}\n#btns {\n    display: flex;\n    flex-direction: column;\n}\n#file {\n    cursor: pointer;\n}\n#text {\n    display: flex;\n    flex-direction: column;\n}\nlabel {\n    margin: 1rem;\n    padding: 0.5rem 0;\n    text-align: center;\n    border-radius: 8px;\n    box-shadow: 2px 2px 8px 5px rgb(0 0 0 / 10%);\n}\ntextarea {\n    padding: 16px;\n}\n#modify {\n    text-align: right;\n}\n.btn {\n    background-color: #1c68e6;\n    border-style: none;\n    outline: none;\n    width: 20%;\n    border-radius: 8px;\n    height: 40px;\n    color: white;\n    margin: 1rem 0 1rem 0;\n}\n@media screen and (max-width: 992px) {\n    #modifyPost {\n        max-width: 90%;\n    }\n}\n</style>"],"sourceRoot":""}]}