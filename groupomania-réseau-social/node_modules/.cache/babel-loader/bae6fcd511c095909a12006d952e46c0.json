{"remainingRequest":"/Users/admin/Desktop/ALICK_SOMAN_P7OPC/groupomania-réseau-social/node_modules/babel-loader/lib/index.js!/Users/admin/Desktop/ALICK_SOMAN_P7OPC/groupomania-réseau-social/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/admin/Desktop/ALICK_SOMAN_P7OPC/groupomania-réseau-social/node_modules/vue-loader-v16/dist/index.js??ref--0-1!/Users/admin/Desktop/ALICK_SOMAN_P7OPC/groupomania-réseau-social/src/components/ModifyPost.vue?vue&type=script&lang=js","dependencies":[{"path":"/Users/admin/Desktop/ALICK_SOMAN_P7OPC/groupomania-réseau-social/src/components/ModifyPost.vue","mtime":1648813759473},{"path":"/Users/admin/Desktop/ALICK_SOMAN_P7OPC/groupomania-réseau-social/node_modules/cache-loader/dist/cjs.js","mtime":1646670308046},{"path":"/Users/admin/Desktop/ALICK_SOMAN_P7OPC/groupomania-réseau-social/node_modules/babel-loader/lib/index.js","mtime":1646670309179},{"path":"/Users/admin/Desktop/ALICK_SOMAN_P7OPC/groupomania-réseau-social/node_modules/cache-loader/dist/cjs.js","mtime":1646670308046},{"path":"/Users/admin/Desktop/ALICK_SOMAN_P7OPC/groupomania-réseau-social/node_modules/vue-loader-v16/dist/index.js","mtime":1646670309571}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9hc3luY1RvR2VuZXJhdG9yIGZyb20gIi9Vc2Vycy9hZG1pbi9EZXNrdG9wL0FMSUNLX1NPTUFOX1A3T1BDL2dyb3Vwb21hbmlhLXJceEU5c2VhdS1zb2NpYWwvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL2FzeW5jVG9HZW5lcmF0b3IiOwppbXBvcnQgX29iamVjdFNwcmVhZCBmcm9tICIvVXNlcnMvYWRtaW4vRGVza3RvcC9BTElDS19TT01BTl9QN09QQy9ncm91cG9tYW5pYS1yXHhFOXNlYXUtc29jaWFsL25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9vYmplY3RTcHJlYWQyIjsKaW1wb3J0ICJyZWdlbmVyYXRvci1ydW50aW1lL3J1bnRpbWUuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5vYmplY3QudG8tc3RyaW5nLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuc3RyaW5nLml0ZXJhdG9yLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvd2ViLmRvbS1jb2xsZWN0aW9ucy5pdGVyYXRvci5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL3dlYi51cmwuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5yZWdleHAuZXhlYy5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnN0cmluZy5zcGxpdC5qcyI7CmltcG9ydCBheGlvcyBmcm9tICdheGlvcyc7CmltcG9ydCByb3V0ZXIgZnJvbSAnLi4vcm91dGVyJzsgLy8gaW1wb3J0IG1vbWVudCBmcm9tICdtb21lbnQnCgpleHBvcnQgZGVmYXVsdCB7CiAgbmFtZTogJ01vZGlmeVBvc3QnLAogIGJlZm9yZUNyZWF0ZTogZnVuY3Rpb24gYmVmb3JlQ3JlYXRlKCkgewogICAgdmFyIF90aGlzID0gdGhpczsKCiAgICAvKiBvbiByw6ljdXDDqHJlIGwnaWQgZHUgcG9zdCB2aWEgbCd1cmwgKi8KICAgIHZhciBwYXJzZWRVcmwgPSBuZXcgVVJMKHdpbmRvdy5sb2NhdGlvbi5ocmVmKTsKICAgIHZhciBwb3N0SWQgPSBwYXJzZWRVcmwucGF0aG5hbWUuc3BsaXQoJy9tb2RpZnktcG9zdC8nKVsxXTsKICAgIC8qIHNlbG9uIGwnaWQgb24gcsOpY3Vww6hyZSBsZSBwb3N0IGNvbmNlcm7DqSAqLwoKICAgIGZldGNoKCJodHRwOi8vbG9jYWxob3N0OjMwMDAvYXBpL3Bvc3RzLyIuY29uY2F0KHBvc3RJZCksIHsKICAgICAgaGVhZGVyczogewogICAgICAgIEF1dGhvcml6YXRpb246ICJCZWFyZXIgIi5jb25jYXQobG9jYWxTdG9yYWdlLmdldEl0ZW0oJ3Rva2VuJykpCiAgICAgIH0KICAgIH0pLnRoZW4oZnVuY3Rpb24gKHJlcykgewogICAgICByZXR1cm4gcmVzLmpzb24oKTsKICAgIH0pLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHsKICAgICAgZGF0YS5maWxlID8gX3RoaXMucHJldmlldyA9IHRydWUgOiBfdGhpcy5wcmV2aWV3ID0gZmFsc2U7CiAgICAgIF90aGlzLnBvc3QgPSBfb2JqZWN0U3ByZWFkKHt9LCBkYXRhKTsKICAgIH0pLmNhdGNoKGZ1bmN0aW9uIChlcnJvcikgewogICAgICBlcnJvcjsKICAgIH0pOwogIH0sCiAgZGF0YTogZnVuY3Rpb24gZGF0YSgpIHsKICAgIHJldHVybiB7CiAgICAgIHBvc3Q6IHt9LAogICAgICBuZXdGaWxlOiAnJywKICAgICAgcHJldmlldzogbnVsbCwKICAgICAgZXJyTXNnOiBudWxsCiAgICB9OwogIH0sCiAgbWV0aG9kczogewogICAgLy8gCiAgICB1cGRhdGVGaWxlOiBmdW5jdGlvbiB1cGRhdGVGaWxlKGV2ZW50KSB7CiAgICAgIC8qIHN1ciBsZSBvbmNoYW5nZSBvbiB2YSBhdHRyaWJ1ZXIgY2V0dGUgdmFsZXVyIMOgIGZpbGUgKG7DqWNlc3NhaXJlIHBvdXIgbCdlbnZvaSBhdSBiYWNrZW5kKSAqLwogICAgICB0aGlzLm5ld0ZpbGUgPSB0aGlzLiRyZWZzLmZpbGUuZmlsZXNbMF07CiAgICAgIHZhciBpbnB1dCA9IGV2ZW50LnRhcmdldDsKCiAgICAgIGlmIChpbnB1dC5maWxlcykgewogICAgICAgIHZhciByZWFkZXIgPSBuZXcgRmlsZVJlYWRlcigpOwoKICAgICAgICByZWFkZXIub25sb2FkID0gZnVuY3Rpb24gKGUpIHsKICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdwcmV2aWV3Jykuc3JjID0gZS50YXJnZXQucmVzdWx0OwogICAgICAgIH07CgogICAgICAgIHJlYWRlci5yZWFkQXNEYXRhVVJMKGlucHV0LmZpbGVzWzBdKTsKICAgICAgICB0aGlzLnByZXZpZXcgPSB0cnVlOwogICAgICB9CiAgICB9LAogICAgbW9kaWZ5UG9zdDogZnVuY3Rpb24gbW9kaWZ5UG9zdCgpIHsKICAgICAgdmFyIF90aGlzMiA9IHRoaXM7CgogICAgICByZXR1cm4gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9yZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlKCkgewogICAgICAgIHZhciBmb3JtRGF0YTsKICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZSQoX2NvbnRleHQpIHsKICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQucHJldiA9IF9jb250ZXh0Lm5leHQpIHsKICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICBpZiAoX3RoaXMyLnBvc3QudGl0bGUpIHsKICAgICAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDM7CiAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIF90aGlzMi5lcnJNc2cgPSAiRXJyb3IgPT4gdm91cyBkZXZleiByZW1wbGlyIGxlIGNoYW1wIDxtZXNzYWdlPiBwb3VyIGNyw6llciB1bmUgbm91dmVsbGUgcHVibGljYXRpb24hIjsKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dC5hYnJ1cHQoInJldHVybiIpOwoKICAgICAgICAgICAgICBjYXNlIDM6CiAgICAgICAgICAgICAgICAvKiBvbiBjcsOpw6kgdW4gb2JqZXQgZm9ybURhdGEgYWZpbiBkZSBwb3V2b2lyIGFqb3V0ZXIgbGUgdGV4dGUgZXQgc3VydG91dCBsZSBmaWxlIGNob2lzaSAqLwogICAgICAgICAgICAgICAgZm9ybURhdGEgPSBuZXcgRm9ybURhdGEoKTsKICAgICAgICAgICAgICAgIGZvcm1EYXRhLmFwcGVuZCgndGl0bGUnLCBfdGhpczIucG9zdC50aXRsZSk7CiAgICAgICAgICAgICAgICBmb3JtRGF0YS5hcHBlbmQoJ3RleHQnLCBfdGhpczIucG9zdC50ZXh0KTsKCiAgICAgICAgICAgICAgICBpZiAoX3RoaXMyLm5ld0ZpbGUpIHsKICAgICAgICAgICAgICAgICAgZm9ybURhdGEuYXBwZW5kKCdmaWxlJywgX3RoaXMyLm5ld0ZpbGUpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgLyogZW52b2kgZHUgZm9ybSB2aWEgYXhpb3MucHV0IGRlIGwnb2JqZXQgZm9ybURhdGEgKi8KCgogICAgICAgICAgICAgICAgaWYgKGNvbmZpcm0oIk1vZGlmaWVyIHZvdHJlIHBvc3QgPyIpKSB7CiAgICAgICAgICAgICAgICAgIGF4aW9zLnB1dCgiaHR0cDovL2xvY2FsaG9zdDozMDAwL2FwaS9wb3N0cy8iLmNvbmNhdChfdGhpczIucG9zdC5pZCksIGZvcm1EYXRhLCB7CiAgICAgICAgICAgICAgICAgICAgaGVhZGVyczogewogICAgICAgICAgICAgICAgICAgICAgQXV0aG9yaXphdGlvbjogIkJlYXJlciAiLmNvbmNhdChsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgndG9rZW4nKSkKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKHJlcykgewogICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKHJlcy5kYXRhKTsKICAgICAgICAgICAgICAgICAgICByb3V0ZXIucHVzaCh7CiAgICAgICAgICAgICAgICAgICAgICBwYXRoOiAnL2hvbWUnCiAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uIChlcnJvcikgewogICAgICAgICAgICAgICAgICAgIHJldHVybiBjb25zb2xlLmxvZyhlcnJvcik7CiAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICBjYXNlIDg6CiAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dC5zdG9wKCk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9LCBfY2FsbGVlKTsKICAgICAgfSkpKCk7CiAgICB9CiAgfQp9Ow=="},{"version":3,"sources":["/Users/admin/Desktop/ALICK_SOMAN_P7OPC/groupomania-réseau-social/src/components/ModifyPost.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\n    <div id=\"modifyPost\">\n        <form @submit.prevent=\"modifyPost\">\n            <div id=\"text\">\n                <label for=\"textarea\">Modifier le titre</label>\n            <input name=\"input\" v-model=\"post.title\">\n            </div> \n            <div id=\"text\">\n                <label for=\"textarea\">Modifier le commentaire</label>\n                <textarea name=\"textarea\" v-model=\"post.text\"></textarea>\n            </div>\n            <div id=\"modify\">\n                <input type=\"submit\" value=\"je modifie !\" class=\"btn\">    \n            </div>\n            <div id=\"btns\">\n                <label for=\"file\">Choisir une nouvelle image</label>\n                <input type=\"file\" ref=\"file\" name=\"file\" class=\"upload\" id=\"file\" @change=\"updateFile\">\n            </div>\n            <div id=\"fileContainer\">\n                <img id=\"preview\" :src=\"'http://localhost:3000/images/' + post.file\" :alt=\"post.file\" v-if=\"preview\">\n                <p v-else>Ce post ne possède pas d'image</p>\n            </div>\n\n            <p>{{errMsg}}</p>\n        </form>\n    </div>\n</template>\n\n<script>\nimport axios from 'axios';\nimport router from '../router'\n// import moment from 'moment'\nexport default {\n    name: 'ModifyPost',\n    beforeCreate() {\n        /* on récupère l'id du post via l'url */\n        const parsedUrl = new URL(window.location.href)\n        const postId = parsedUrl.pathname.split('/modify-post/')[1]\n        /* selon l'id on récupère le post concerné */\n        fetch(`http://localhost:3000/api/posts/${postId}`, {\n            headers: {\n                Authorization: `Bearer ${localStorage.getItem('token')}`\n            }\n        })\n            .then(res => res.json())\n            .then(data => {\n                data.file ? this.preview = true : this.preview = false\n                this.post = {...data}\n            })\n            .catch(error => {error})\n    },\n    data() {\n        return {\n            post: {},\n            newFile: '',\n            preview: null,\n            errMsg: null\n        }\n    },\n    methods: {\n// \n        updateFile(event) {\n            /* sur le onchange on va attribuer cette valeur à file (nécessaire pour l'envoi au backend) */ \n            this.newFile = this.$refs.file.files[0]\n            let input = event.target\n            if(input.files) {\n                let reader = new FileReader()\n                reader.onload = (e) => {\n                    document.getElementById('preview').src = e.target.result\n                }\n                reader.readAsDataURL(input.files[0])\n                this.preview = true\n            }\n        },\n        async modifyPost() {\n            /* on peut envoyer un post sans image mais il faut au moins qu'il y est un texte */     \n            if (!this.post.title) {\n                this.errMsg = \"Error => vous devez remplir le champ <message> pour créer une nouvelle publication!\"\n                return\n            }\n            /* on créé un objet formData afin de pouvoir ajouter le texte et surtout le file choisi */\n            let formData = new FormData()\n            formData.append('title', this.post.title)\n            formData.append('text', this.post.text)\n            if (this.newFile) {\n                formData.append('file', this.newFile)\n            }\n            /* envoi du form via axios.put de l'objet formData */\n            if (confirm(\"Modifier votre post ?\")) {\n                axios.put(`http://localhost:3000/api/posts/${this.post.id}`, formData, {\n                    headers: {\n                        Authorization: `Bearer ${localStorage.getItem('token')}`\n                    },\n                })  \n                    .then(res => {\n                        console.log(res.data)\n                        router.push({ path: '/home' })                                               \n                    })\n                    .catch(error => console.log(error))\n            }            \n        }\n    }\n}\n</script>\n\n<style scoped>\n#modifyPost {\n    max-width: 60%;\n    box-shadow: 2px 2px 8px 5px rgb(0 0 0 / 10%);\n    margin: auto;\n    margin-top: 2rem;\n    padding: 1rem;\n    border-radius: 4px;\n}\nform {\n    display: flex;\n    flex-direction: column;\n}\n#fileContainer {\n    overflow: hidden;\n    margin: 1rem 0 1rem 0;\n}\nimg {\n    height: 100%;\n    width: 100%;\n    object-fit: cover;\n}\n#btns {\n    display: flex;\n    flex-direction: column;\n}\n#file {\n    cursor: pointer;\n}\n#text {\n    display: flex;\n    flex-direction: column;\n}\nlabel {\n    margin: 1rem;\n    padding: 0.5rem 0;\n    text-align: center;\n    border-radius: 8px;\n    box-shadow: 2px 2px 8px 5px rgb(0 0 0 / 10%);\n}\ntextarea {\n    padding: 16px;\n}\n#modify {\n    text-align: right;\n}\n.btn {\n    background-color: #002b5c;\n    border-style: none;\n    outline: none;\n    width: 20%;\n    border-radius: 8px;\n    height: 40px;\n    color: white;\n    margin: 1rem 0 1rem 0;\n}\n@media screen and (max-width: 992px) {\n    #modifyPost {\n        max-width: 90%;\n    }\n}\n</style>"],"sourceRoot":""}]}