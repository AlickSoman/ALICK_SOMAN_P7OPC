{"remainingRequest":"/Users/admin/Desktop/P7_ALICK_SOMAN/vue-frontend/node_modules/babel-loader/lib/index.js!/Users/admin/Desktop/P7_ALICK_SOMAN/vue-frontend/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/admin/Desktop/P7_ALICK_SOMAN/vue-frontend/node_modules/vue-loader-v16/dist/index.js??ref--0-1!/Users/admin/Desktop/P7_ALICK_SOMAN/vue-frontend/src/views/Login.vue?vue&type=script&lang=js","dependencies":[{"path":"/Users/admin/Desktop/P7_ALICK_SOMAN/vue-frontend/src/views/Login.vue","mtime":1631120511000},{"path":"/Users/admin/Desktop/P7_ALICK_SOMAN/vue-frontend/node_modules/cache-loader/dist/cjs.js","mtime":1646670308046},{"path":"/Users/admin/Desktop/P7_ALICK_SOMAN/vue-frontend/node_modules/babel-loader/lib/index.js","mtime":1646670309179},{"path":"/Users/admin/Desktop/P7_ALICK_SOMAN/vue-frontend/node_modules/cache-loader/dist/cjs.js","mtime":1646670308046},{"path":"/Users/admin/Desktop/P7_ALICK_SOMAN/vue-frontend/node_modules/vue-loader-v16/dist/index.js","mtime":1646670309571}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9vYmplY3RTcHJlYWQgZnJvbSAiL1VzZXJzL2FkbWluL0Rlc2t0b3AvUDdfQUxJQ0tfU09NQU4vdnVlLWZyb250ZW5kL25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9vYmplY3RTcHJlYWQyIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMub2JqZWN0LnRvLXN0cmluZy5qcyI7CmltcG9ydCBzdG9yZSBmcm9tICcuLi9zdG9yZS9pbmRleC5qcyc7CmltcG9ydCBOYXYgZnJvbSAnLi4vY29tcG9uZW50cy9OYXYudnVlJzsKaW1wb3J0IHJvdXRlciBmcm9tICcuLi9yb3V0ZXInOwpleHBvcnQgZGVmYXVsdCB7CiAgbmFtZTogJ0xvZ2luJywKICBjb21wb25lbnRzOiB7CiAgICBOYXY6IE5hdgogIH0sCiAgZGF0YTogZnVuY3Rpb24gZGF0YSgpIHsKICAgIHJldHVybiB7CiAgICAgIGRhdGFGb3JtOiB7CiAgICAgICAgZW1haWw6IG51bGwsCiAgICAgICAgcGFzc3dvcmQ6IG51bGwKICAgICAgfSwKICAgICAgZXJyTXNnOiBudWxsCiAgICB9OwogIH0sCiAgbWV0aG9kczogewogICAgb25TdWJtaXQ6IGZ1bmN0aW9uIG9uU3VibWl0KCkgewogICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgICAgLyogYXNzaWduZSBsZXMgdmFsZXVycyBkdSBmb3JtIMOgIGwnb2JqZXQgZGF0YSAqLwogICAgICB2YXIgZGF0YSA9IF9vYmplY3RTcHJlYWQoe30sIHRoaXMuZGF0YUZvcm0pOwogICAgICAvKiB2w6lyaWZpZSBzaSB0b3VzIGxlcyBjaGFtcHMgc29udCBiaWVuIHJlbXBsaXMgKi8KCgogICAgICBpZiAoIWRhdGEuZW1haWwgfHwgIWRhdGEucGFzc3dvcmQpIHsKICAgICAgICB0aGlzLmVyck1zZyA9ICJFcnIhIFJlbXBsaXNzZXogdG91cyBsZXMgY2hhbXBzIGR1IGZvcm11bGFpcmUiOwogICAgICAgIHJldHVybjsKICAgICAgfQogICAgICAvKiBtw6l0aG9kZSBQT1NUIHBvdXIgbCdlbnZvaSBkZSBib2R5ICovCgoKICAgICAgZmV0Y2goJ2h0dHA6Ly9sb2NhbGhvc3Q6MzAwMC9hcGkvdXNlcnMvbG9naW4nLCB7CiAgICAgICAgbWV0aG9kOiAnUE9TVCcsCiAgICAgICAgbW9kZTogJ2NvcnMnLAogICAgICAgIGhlYWRlcnM6IHsKICAgICAgICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicKICAgICAgICB9LAogICAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KGRhdGEpCiAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKHJlcykgewogICAgICAgIHZhciBsb2NhbERhdGEgPSByZXM7CiAgICAgICAgc3RvcmUuc3RhdGUuaXNMb2dnZWQgPSB0cnVlOyAvLyA8LSBvbiBlbnZvaSBsZSBib29sw6lhbiB0cnVlIGFmaW4gZCdvdXZyaXIgbCdpbnRlcmNlcHRldXIgZGUgbmF2aWdhdGlvbgoKICAgICAgICBsb2NhbERhdGEuanNvbigpLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHsKICAgICAgICAgIC8qIG9uIHLDqWN1cMOocmUgZGFucyBsb2NhbFN0b3JhZ2UgbGVzIHZhbGV1cnMgZ8OpbsOpcsOpcyBwYXIgbGUgdG9rZW4gKi8KICAgICAgICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKCd0b2tlbicsIGRhdGEudG9rZW4pOwogICAgICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oJ3VzZXJJZCcsIGRhdGEudXNlcklkKTsKICAgICAgICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKCdpc0FkbWluJywgZGF0YS5pc0FkbWluKTsKICAgICAgICB9KTsKICAgICAgICAvKiBzaSBsYSByw6lwb25zZSBlc3QgMjAwIGFsb3JzIG9uIGVudHJlICovCgogICAgICAgIGlmIChyZXMuc3RhdHVzID09PSAyMDApIHsKICAgICAgICAgIHJvdXRlci5wdXNoKHsKICAgICAgICAgICAgcGF0aDogJ2hvbWUnCiAgICAgICAgICB9KTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgX3RoaXMuZXJyTXNnID0gIkVtYWlsIG91IG1vdCBkZSBwYXNzZSBpbmNvcnJlY3QiOwogICAgICAgIH0KICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKGVycm9yKSB7CiAgICAgICAgY29uc29sZS5lcnJvcihlcnJvcik7CiAgICAgIH0pOwogICAgfQogIH0KfTs="},{"version":3,"sources":["/Users/admin/Desktop/P7_ALICK_SOMAN/vue-frontend/src/views/Login.vue"],"names":[],"mappings":";;AAeA,OAAO,KAAP,MAAkB,mBAAlB;AACA,OAAO,GAAP,MAAgB,uBAAhB;AACA,OAAO,MAAP,MAAmB,WAAnB;AACA,eAAe;AACX,EAAA,IAAI,EAAE,OADK;AAEX,EAAA,UAAU,EAAE;AACR,IAAA,GAAE,EAAF;AADQ,GAFD;AAKX,EAAA,IALW,kBAKJ;AACH,WAAO;AACH,MAAA,QAAQ,EAAE;AACN,QAAA,KAAK,EAAE,IADD;AAEN,QAAA,QAAQ,EAAE;AAFJ,OADP;AAKH,MAAA,MAAM,EAAE;AALL,KAAP;AAOH,GAbU;AAcX,EAAA,OAAO,EAAE;AACL,IAAA,QADK,sBACM;AAAA;;AACP;AACA,UAAM,IAAG,qBACF,KAAK,QADH,CAAT;AAGA;;;AACA,UAAI,CAAC,IAAI,CAAC,KAAN,IAAe,CAAC,IAAI,CAAC,QAAzB,EAAmC;AAC/B,aAAK,MAAL,GAAc,+CAAd;AACA;AACJ;AACA;;;AACA,MAAA,KAAK,CAAC,uCAAD,EAA0C;AAC3C,QAAA,MAAM,EAAE,MADmC;AAE3C,QAAA,IAAI,EAAE,MAFqC;AAG3C,QAAA,OAAO,EAAE;AACL,0BAAgB;AADX,SAHkC;AAM3C,QAAA,IAAI,EAAE,IAAI,CAAC,SAAL,CAAe,IAAf;AANqC,OAA1C,CAAL,CAQK,IARL,CAQU,UAAA,GAAE,EAAK;AACT,YAAM,SAAQ,GAAI,GAAlB;AACA,QAAA,KAAK,CAAC,KAAN,CAAY,QAAZ,GAAuB,IAAvB,CAFS,CAEmB;;AAC5B,QAAA,SAAS,CAAC,IAAV,GAAiB,IAAjB,CAAsB,UAAA,IAAG,EAAK;AAC1B;AACA,UAAA,YAAY,CAAC,OAAb,CAAqB,OAArB,EAA8B,IAAI,CAAC,KAAnC;AACA,UAAA,YAAY,CAAC,OAAb,CAAqB,QAArB,EAA+B,IAAI,CAAC,MAApC;AACA,UAAA,YAAY,CAAC,OAAb,CAAqB,SAArB,EAAgC,IAAI,CAAC,OAArC;AACH,SALD;AAMA;;AACA,YAAI,GAAG,CAAC,MAAJ,KAAe,GAAnB,EAAyB;AACrB,UAAA,MAAM,CAAC,IAAP,CAAY;AAAE,YAAA,IAAI,EAAE;AAAR,WAAZ;AACJ,SAFA,MAEQ;AACJ,UAAA,KAAI,CAAC,MAAL,GAAc,iCAAd;AACJ;AACH,OAvBL,EAwBK,KAxBL,CAwBW,UAAA,KAAI,EAAK;AAAC,QAAA,OAAO,CAAC,KAAR,CAAc,KAAd;AAAqB,OAxB1C;AAyBJ;AArCK;AAdE,CAAf","sourcesContent":["<template>\n    <Nav redirection=\"/login\" :logged=\"false\"/>\n    <div id=\"loginForm\">\n        <h3>Login</h3>\n        <form @submit.prevent=\"onSubmit\">\n            <input type=\"email\" name=\"email\" placeholder=\"Email\" v-model=\"dataForm.email\">\n            <input type=\"password\" name=\"password\" placeholder=\"Mot de passe\" v-model=\"dataForm.password\">\n            <input type=\"submit\" value=\"Login !\" class=\"btn\">\n        </form>\n        <h4>{{ errMsg }}</h4>\n        <p>Je n'ai pas créé de compte ? Cliquez ici: <router-link to=\"/signup\">Signup</router-link></p>\n    </div>\n</template>\n\n<script>\nimport store from '../store/index.js'\nimport Nav from '../components/Nav.vue'\nimport router from '../router'\nexport default {\n    name: 'Login',\n    components: {\n        Nav\n    },\n    data() {\n        return {\n            dataForm: {\n                email: null,\n                password: null  \n            },\n            errMsg: null\n        }\n    },\n    methods: {\n        onSubmit() {\n            /* assigne les valeurs du form à l'objet data */\n            const data = {\n                ...this.dataForm\n            }      \n            /* vérifie si tous les champs sont bien remplis */\n            if (!data.email || !data.password) {\n                this.errMsg = \"Err! Remplissez tous les champs du formulaire\"\n                return\n            }\n            /* méthode POST pour l'envoi de body */\n            fetch('http://localhost:3000/api/users/login', {\n                method: 'POST',\n                mode: 'cors',\n                headers: {\n                    'Content-Type': 'application/json'\n                },\n                body: JSON.stringify(data)\n            })\n                .then(res => {\n                    const localData = res\n                    store.state.isLogged = true // <- on envoi le booléan true afin d'ouvrir l'intercepteur de navigation\n                    localData.json().then(data => {\n                        /* on récupère dans localStorage les valeurs générés par le token */\n                        localStorage.setItem('token', data.token)\n                        localStorage.setItem('userId', data.userId)\n                        localStorage.setItem('isAdmin', data.isAdmin)\n                    })\n                    /* si la réponse est 200 alors on entre */\n                    if (res.status === 200 ) {\n                        router.push({ path: 'home' })\n                    }  else {\n                        this.errMsg = \"Email ou mot de passe incorrect\"\n                    }             \n                })                \n                .catch(error => {console.error(error)})\n        }\n    }\n}\n</script>\n\n<style scoped>\n#loginForm {\n    margin: 3rem;\n    display: flex;\n    justify-content: center;\n    align-content: center;\n    flex-wrap: wrap;\n    flex-direction: column;\n    align-items: center;\n}\nh3 {\n    background: no-repeat center url('../assets/logos/icon.png');\n    background-size: cover;\n    height: 160px;\n    width: 160px;\n    text-align: center;\n}\nform {\n    display: flex;\n    flex-direction: column;\n    width: 400px;\n}\ninput {\n    margin: 0.8rem;\n    padding: 10px;\n    box-shadow: 2px 2px 8px 5px rgb(0 0 0 / 10%);\n    border-style: none;\n    border-radius: 4px;\n    outline: none;\n}\ninput:hover {\n    box-shadow: 2px 2px 8px 5px rgb(0 0 0 / 18%);\n}\n.btn {\n    color: white;\n    background-color: rgba(0, 128, 0, 0.836);\n    margin: 2rem;\n}\n@media screen and (max-width: 992px) {\n    form {\n        width: 100%;\n    }\n}\n</style>"],"sourceRoot":""}]}