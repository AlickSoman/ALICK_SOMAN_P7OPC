{"remainingRequest":"/Users/admin/Desktop/P7_ALICK_SOMAN/vue-frontend/node_modules/babel-loader/lib/index.js!/Users/admin/Desktop/P7_ALICK_SOMAN/vue-frontend/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/admin/Desktop/P7_ALICK_SOMAN/vue-frontend/node_modules/vue-loader-v16/dist/index.js??ref--0-1!/Users/admin/Desktop/P7_ALICK_SOMAN/vue-frontend/src/components/ModifyPost.vue?vue&type=script&lang=js","dependencies":[{"path":"/Users/admin/Desktop/P7_ALICK_SOMAN/vue-frontend/src/components/ModifyPost.vue","mtime":1631120511000},{"path":"/Users/admin/Desktop/P7_ALICK_SOMAN/vue-frontend/node_modules/cache-loader/dist/cjs.js","mtime":1646670308046},{"path":"/Users/admin/Desktop/P7_ALICK_SOMAN/vue-frontend/node_modules/babel-loader/lib/index.js","mtime":1646670309179},{"path":"/Users/admin/Desktop/P7_ALICK_SOMAN/vue-frontend/node_modules/cache-loader/dist/cjs.js","mtime":1646670308046},{"path":"/Users/admin/Desktop/P7_ALICK_SOMAN/vue-frontend/node_modules/vue-loader-v16/dist/index.js","mtime":1646670309571}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9hc3luY1RvR2VuZXJhdG9yIGZyb20gIi9Vc2Vycy9hZG1pbi9EZXNrdG9wL1A3X0FMSUNLX1NPTUFOL3Z1ZS1mcm9udGVuZC9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vYXN5bmNUb0dlbmVyYXRvciI7CmltcG9ydCBfb2JqZWN0U3ByZWFkIGZyb20gIi9Vc2Vycy9hZG1pbi9EZXNrdG9wL1A3X0FMSUNLX1NPTUFOL3Z1ZS1mcm9udGVuZC9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vb2JqZWN0U3ByZWFkMiI7CmltcG9ydCAicmVnZW5lcmF0b3ItcnVudGltZS9ydW50aW1lLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMub2JqZWN0LnRvLXN0cmluZy5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnN0cmluZy5pdGVyYXRvci5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL3dlYi5kb20tY29sbGVjdGlvbnMuaXRlcmF0b3IuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy93ZWIudXJsLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMucmVnZXhwLmV4ZWMuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5zdHJpbmcuc3BsaXQuanMiOwppbXBvcnQgYXhpb3MgZnJvbSAnYXhpb3MnOwppbXBvcnQgcm91dGVyIGZyb20gJy4uL3JvdXRlcic7CmV4cG9ydCBkZWZhdWx0IHsKICBuYW1lOiAnTW9kaWZ5UG9zdCcsCiAgYmVmb3JlQ3JlYXRlOiBmdW5jdGlvbiBiZWZvcmVDcmVhdGUoKSB7CiAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgIC8qIG9uIHLDqWN1cMOocmUgbCdpZCBkdSBwb3N0IHZpYSBsJ3VybCAqLwogICAgdmFyIHBhcnNlZFVybCA9IG5ldyBVUkwod2luZG93LmxvY2F0aW9uLmhyZWYpOwogICAgdmFyIHBvc3RJZCA9IHBhcnNlZFVybC5wYXRobmFtZS5zcGxpdCgnL21vZGlmeS1wb3N0LycpWzFdOwogICAgLyogc2Vsb24gbCdpZCBvbiByw6ljdXDDqHJlIGxlIHBvc3QgY29uY2VybsOpICovCgogICAgZmV0Y2goImh0dHA6Ly9sb2NhbGhvc3Q6MzAwMC9hcGkvcG9zdHMvIi5jb25jYXQocG9zdElkKSwgewogICAgICBoZWFkZXJzOiB7CiAgICAgICAgQXV0aG9yaXphdGlvbjogIkJlYXJlciAiLmNvbmNhdChsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgndG9rZW4nKSkKICAgICAgfQogICAgfSkudGhlbihmdW5jdGlvbiAocmVzKSB7CiAgICAgIHJldHVybiByZXMuanNvbigpOwogICAgfSkudGhlbihmdW5jdGlvbiAoZGF0YSkgewogICAgICBkYXRhLmZpbGUgPyBfdGhpcy5wcmV2aWV3ID0gdHJ1ZSA6IF90aGlzLnByZXZpZXcgPSBmYWxzZTsKICAgICAgX3RoaXMucG9zdCA9IF9vYmplY3RTcHJlYWQoe30sIGRhdGEpOwogICAgfSkuY2F0Y2goZnVuY3Rpb24gKGVycm9yKSB7CiAgICAgIGVycm9yOwogICAgfSk7CiAgfSwKICBkYXRhOiBmdW5jdGlvbiBkYXRhKCkgewogICAgcmV0dXJuIHsKICAgICAgcG9zdDoge30sCiAgICAgIG5ld0ZpbGU6ICcnLAogICAgICBwcmV2aWV3OiBudWxsLAogICAgICBlcnJNc2c6IG51bGwKICAgIH07CiAgfSwKICBtZXRob2RzOiB7CiAgICB1cGRhdGVGaWxlOiBmdW5jdGlvbiB1cGRhdGVGaWxlKGV2ZW50KSB7CiAgICAgIC8qIHN1ciBsZSBvbmNoYW5nZSBvbiB2YSBhdHRyaWJ1ZXIgY2V0dGUgdmFsZXVyIMOgIGZpbGUgKG7DqWNlc3NhaXJlIHBvdXIgbCdlbnZvaSBhdSBiYWNrZW5kKSAqLwogICAgICB0aGlzLm5ld0ZpbGUgPSB0aGlzLiRyZWZzLmZpbGUuZmlsZXNbMF07CiAgICAgIHZhciBpbnB1dCA9IGV2ZW50LnRhcmdldDsKCiAgICAgIGlmIChpbnB1dC5maWxlcykgewogICAgICAgIHZhciByZWFkZXIgPSBuZXcgRmlsZVJlYWRlcigpOwoKICAgICAgICByZWFkZXIub25sb2FkID0gZnVuY3Rpb24gKGUpIHsKICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdwcmV2aWV3Jykuc3JjID0gZS50YXJnZXQucmVzdWx0OwogICAgICAgIH07CgogICAgICAgIHJlYWRlci5yZWFkQXNEYXRhVVJMKGlucHV0LmZpbGVzWzBdKTsKICAgICAgICB0aGlzLnByZXZpZXcgPSB0cnVlOwogICAgICB9CiAgICB9LAogICAgbW9kaWZ5UG9zdDogZnVuY3Rpb24gbW9kaWZ5UG9zdCgpIHsKICAgICAgdmFyIF90aGlzMiA9IHRoaXM7CgogICAgICByZXR1cm4gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9yZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlKCkgewogICAgICAgIHZhciBmb3JtRGF0YTsKICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZSQoX2NvbnRleHQpIHsKICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQucHJldiA9IF9jb250ZXh0Lm5leHQpIHsKICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICBpZiAoX3RoaXMyLnBvc3QudGV4dCkgewogICAgICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gMzsKICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgX3RoaXMyLmVyck1zZyA9ICJFcnJvciA9PiB2b3VzIGRldmV6IHJlbXBsaXIgbGUgY2hhbXAgPG1lc3NhZ2U+IHBvdXIgY3LDqWVyIHVuZSBub3V2ZWxsZSBwdWJsaWNhdGlvbiEiOwogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0LmFicnVwdCgicmV0dXJuIik7CgogICAgICAgICAgICAgIGNhc2UgMzoKICAgICAgICAgICAgICAgIC8qIG9uIGNyw6nDqSB1biBvYmpldCBmb3JtRGF0YSBhZmluIGRlIHBvdXZvaXIgYWpvdXRlciBsZSB0ZXh0ZSBldCBzdXJ0b3V0IGxlIGZpbGUgY2hvaXNpICovCiAgICAgICAgICAgICAgICBmb3JtRGF0YSA9IG5ldyBGb3JtRGF0YSgpOwogICAgICAgICAgICAgICAgZm9ybURhdGEuYXBwZW5kKCd0ZXh0JywgX3RoaXMyLnBvc3QudGV4dCk7CgogICAgICAgICAgICAgICAgaWYgKF90aGlzMi5uZXdGaWxlKSB7CiAgICAgICAgICAgICAgICAgIGZvcm1EYXRhLmFwcGVuZCgnZmlsZScsIF90aGlzMi5uZXdGaWxlKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIC8qIGVudm9pIGR1IGZvcm0gdmlhIGF4aW9zLnB1dCBkZSBsJ29iamV0IGZvcm1EYXRhICovCgoKICAgICAgICAgICAgICAgIGlmIChjb25maXJtKCLDqnRlcyB2b3VzIHPDu3IgZGUgdm91bG9pciBtb2RpZmllciB2b3RyZSBwb3N0ID8iKSkgewogICAgICAgICAgICAgICAgICBheGlvcy5wdXQoImh0dHA6Ly9sb2NhbGhvc3Q6MzAwMC9hcGkvcG9zdHMvIi5jb25jYXQoX3RoaXMyLnBvc3QuaWQpLCBmb3JtRGF0YSwgewogICAgICAgICAgICAgICAgICAgIGhlYWRlcnM6IHsKICAgICAgICAgICAgICAgICAgICAgIEF1dGhvcml6YXRpb246ICJCZWFyZXIgIi5jb25jYXQobG9jYWxTdG9yYWdlLmdldEl0ZW0oJ3Rva2VuJykpCiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICB9KS50aGVuKGZ1bmN0aW9uIChyZXMpIHsKICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhyZXMuZGF0YSk7CiAgICAgICAgICAgICAgICAgICAgcm91dGVyLnB1c2goewogICAgICAgICAgICAgICAgICAgICAgcGF0aDogJy9ob21lJwogICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICB9KS5jYXRjaChmdW5jdGlvbiAoZXJyb3IpIHsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gY29uc29sZS5sb2coZXJyb3IpOwogICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgY2FzZSA3OgogICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuc3RvcCgpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSwgX2NhbGxlZSk7CiAgICAgIH0pKSgpOwogICAgfQogIH0KfTs="},{"version":3,"sources":["/Users/admin/Desktop/P7_ALICK_SOMAN/vue-frontend/src/components/ModifyPost.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\n    <div id=\"modifyPost\">\n        <form @submit.prevent=\"modifyPost\">\n            <div id=\"btns\">\n                <label for=\"file\">Choisir une nouvelle image</label>\n                <input type=\"file\" ref=\"file\" name=\"file\" class=\"upload\" id=\"file\" @change=\"updateFile\">\n            </div>\n            <div id=\"fileContainer\">\n                <img id=\"preview\" :src=\"'http://localhost:3000/images/' + post.file\" :alt=\"post.file\" v-if=\"preview\">\n                <p v-else>Ce post ne possède pas d'image</p>\n            </div>\n            <div id=\"text\">\n                <label for=\"textarea\">Changer votre texte</label>\n                <textarea name=\"textarea\" v-model=\"post.text\"></textarea>\n            </div>\n            <div id=\"modify\">\n                <input type=\"submit\" value=\"je modifie !\" class=\"btn\">    \n            </div>\n            <p>{{errMsg}}</p>\n        </form>\n    </div>\n</template>\n\n<script>\nimport axios from 'axios';\nimport router from '../router'\nexport default {\n    name: 'ModifyPost',\n    beforeCreate() {\n        /* on récupère l'id du post via l'url */\n        const parsedUrl = new URL(window.location.href)\n        const postId = parsedUrl.pathname.split('/modify-post/')[1]\n        /* selon l'id on récupère le post concerné */\n        fetch(`http://localhost:3000/api/posts/${postId}`, {\n            headers: {\n                Authorization: `Bearer ${localStorage.getItem('token')}`\n            }\n        })\n            .then(res => res.json())\n            .then(data => {\n                data.file ? this.preview = true : this.preview = false\n                this.post = {...data}\n            })\n            .catch(error => {error})\n    },\n    data() {\n        return {\n            post: {},\n            newFile: '',\n            preview: null,\n            errMsg: null\n        }\n    },\n    methods: {\n        updateFile(event) {\n            /* sur le onchange on va attribuer cette valeur à file (nécessaire pour l'envoi au backend) */ \n            this.newFile = this.$refs.file.files[0]\n            let input = event.target\n            if(input.files) {\n                let reader = new FileReader()\n                reader.onload = (e) => {\n                    document.getElementById('preview').src = e.target.result\n                }\n                reader.readAsDataURL(input.files[0])\n                this.preview = true\n            }\n        },\n        async modifyPost() {\n            /* on peut envoyer un post sans image mais il faut au moins qu'il y est un texte */     \n            if (!this.post.text) {\n                this.errMsg = \"Error => vous devez remplir le champ <message> pour créer une nouvelle publication!\"\n                return\n            }\n            /* on créé un objet formData afin de pouvoir ajouter le texte et surtout le file choisi */\n            let formData = new FormData()\n            formData.append('text', this.post.text)\n            if (this.newFile) {\n                formData.append('file', this.newFile)\n            }\n            /* envoi du form via axios.put de l'objet formData */\n            if (confirm(\"êtes vous sûr de vouloir modifier votre post ?\")) {\n                axios.put(`http://localhost:3000/api/posts/${this.post.id}`, formData, {\n                    headers: {\n                        Authorization: `Bearer ${localStorage.getItem('token')}`\n                    },\n                })  \n                    .then(res => {\n                        console.log(res.data)\n                        router.push({ path: '/home' })                                               \n                    })\n                    .catch(error => console.log(error))\n            }            \n        }\n    }\n}\n</script>\n\n<style scoped>\n#modifyPost {\n    max-width: 60%;\n    box-shadow: 2px 2px 8px 5px rgb(0 0 0 / 10%);\n    margin: auto;\n    margin-top: 2rem;\n    padding: 1rem;\n    border-radius: 4px;\n}\nform {\n    display: flex;\n    flex-direction: column;\n}\n#fileContainer {\n    overflow: hidden;\n    margin: 1rem 0 1rem 0;\n}\nimg {\n    height: 100%;\n    width: 100%;\n    object-fit: cover;\n}\n#btns {\n    display: flex;\n    flex-direction: column;\n}\n#file {\n    cursor: pointer;\n}\n#text {\n    display: flex;\n    flex-direction: column;\n}\nlabel {\n    margin: 1rem;\n    padding: 0.5rem 0;\n    text-align: center;\n    border-radius: 8px;\n    box-shadow: 2px 2px 8px 5px rgb(0 0 0 / 10%);\n}\ntextarea {\n    padding: 16px;\n}\n#modify {\n    text-align: right;\n}\n.btn {\n    background-color: #1c68e6;\n    border-style: none;\n    outline: none;\n    width: 20%;\n    border-radius: 8px;\n    height: 40px;\n    color: white;\n    margin: 1rem 0 1rem 0;\n}\n@media screen and (max-width: 992px) {\n    #modifyPost {\n        max-width: 90%;\n    }\n}\n</style>"],"sourceRoot":""}]}