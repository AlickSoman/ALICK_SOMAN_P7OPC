{"remainingRequest":"/Users/admin/Desktop/P7_ALICK_SOMAN/vue-frontend/node_modules/babel-loader/lib/index.js!/Users/admin/Desktop/P7_ALICK_SOMAN/vue-frontend/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/admin/Desktop/P7_ALICK_SOMAN/vue-frontend/node_modules/vue-loader-v16/dist/index.js??ref--0-1!/Users/admin/Desktop/P7_ALICK_SOMAN/vue-frontend/src/components/CreatePost.vue?vue&type=script&lang=js","dependencies":[{"path":"/Users/admin/Desktop/P7_ALICK_SOMAN/vue-frontend/src/components/CreatePost.vue","mtime":1631120511000},{"path":"/Users/admin/Desktop/P7_ALICK_SOMAN/vue-frontend/node_modules/cache-loader/dist/cjs.js","mtime":1646670308046},{"path":"/Users/admin/Desktop/P7_ALICK_SOMAN/vue-frontend/node_modules/babel-loader/lib/index.js","mtime":1646670309179},{"path":"/Users/admin/Desktop/P7_ALICK_SOMAN/vue-frontend/node_modules/cache-loader/dist/cjs.js","mtime":1646670308046},{"path":"/Users/admin/Desktop/P7_ALICK_SOMAN/vue-frontend/node_modules/vue-loader-v16/dist/index.js","mtime":1646670309571}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IGF4aW9zIGZyb20gJ2F4aW9zJzsKZXhwb3J0IGRlZmF1bHQgewogIG5hbWU6ICdDcmVhdGVQb3N0JywKICBkYXRhOiBmdW5jdGlvbiBkYXRhKCkgewogICAgcmV0dXJuIHsKICAgICAgdGV4dDogbnVsbCwKICAgICAgZmlsZTogJycsCiAgICAgIHByZXZpZXc6IG51bGwsCiAgICAgIGVyck1zZzogbnVsbAogICAgfTsKICB9LAogIG1ldGhvZHM6IHsKICAgIHNlbGVjdEZpbGU6IGZ1bmN0aW9uIHNlbGVjdEZpbGUoZXZlbnQpIHsKICAgICAgdmFyIF90aGlzID0gdGhpczsKCiAgICAgIC8qIHN1ciBsZSBvbmNoYW5nZSBvbiB2YSBhdHRyaWJ1ZXIgY2V0dGUgdmFsZXVyIMOgIGZpbGUgKG7DqWNlc3NhaXJlIHBvdXIgbCdlbnZvaSBhdSBiYWNrZW5kKSAqLwogICAgICB0aGlzLmZpbGUgPSB0aGlzLiRyZWZzLmZpbGUuZmlsZXNbMF07CiAgICAgIHZhciBpbnB1dCA9IGV2ZW50LnRhcmdldDsKCiAgICAgIGlmIChpbnB1dC5maWxlcykgewogICAgICAgIHZhciByZWFkZXIgPSBuZXcgRmlsZVJlYWRlcigpOwoKICAgICAgICByZWFkZXIub25sb2FkID0gZnVuY3Rpb24gKGUpIHsKICAgICAgICAgIF90aGlzLnByZXZpZXcgPSBlLnRhcmdldC5yZXN1bHQ7CiAgICAgICAgfTsKCiAgICAgICAgcmVhZGVyLnJlYWRBc0RhdGFVUkwoaW5wdXQuZmlsZXNbMF0pOwogICAgICB9CiAgICB9LAogICAgY3JlYXRlUG9zdDogZnVuY3Rpb24gY3JlYXRlUG9zdCgpIHsKICAgICAgdmFyIF90aGlzMiA9IHRoaXM7CgogICAgICAvKiBvbiBwZXV0IGVudm95ZXIgdW4gcG9zdCBzYW5zIGltYWdlIG1haXMgaWwgZmF1dCBhdSBtb2lucyBxdSdpbCB5IGVzdCB1biB0ZXh0ZSAqLwogICAgICBpZiAoIXRoaXMudGV4dCkgewogICAgICAgIHRoaXMuZXJyTXNnID0gIkVycm9yID0+IHZvdXMgZGV2ZXogcmVtcGxpciBsZSBjaGFtcCA8bWVzc2FnZT4gcG91ciBjcsOpZXIgdW5lIG5vdXZlbGxlIHB1YmxpY2F0aW9uISI7CiAgICAgICAgcmV0dXJuOwogICAgICB9CiAgICAgIC8qIG9uIGNyw6nDqSB1biBvYmpldCBmb3JtRGF0YSBhZmluIGRlIHBvdXZvaXIgYWpvdXRlciBsZSB0ZXh0ZSBldCBzdXJ0b3V0IGxlIGZpbGUgY2hvaXNpICovCgoKICAgICAgdmFyIGZvcm1EYXRhID0gbmV3IEZvcm1EYXRhKCk7CiAgICAgIGZvcm1EYXRhLmFwcGVuZCgndGV4dCcsIHRoaXMudGV4dCk7CiAgICAgIGZvcm1EYXRhLmFwcGVuZCgnZmlsZScsIHRoaXMuZmlsZSk7CiAgICAgIGZvcm1EYXRhLmFwcGVuZCgndXNlcklkJywgbG9jYWxTdG9yYWdlLmdldEl0ZW0oJ3VzZXJJZCcpKTsKICAgICAgLyogZW52b2kgZHUgZm9ybSB2aWEgYXhpb3MucHV0IGRlIGwnb2JqZXQgZm9ybURhdGEgKi8KCiAgICAgIGF4aW9zLnBvc3QoJ2h0dHA6Ly9sb2NhbGhvc3Q6MzAwMC9hcGkvcG9zdHMvY3JlYXRlJywgZm9ybURhdGEsIHsKICAgICAgICBoZWFkZXJzOiB7CiAgICAgICAgICBBdXRob3JpemF0aW9uOiAiQmVhcmVyICIuY29uY2F0KGxvY2FsU3RvcmFnZS5nZXRJdGVtKCd0b2tlbicpKQogICAgICAgIH0KICAgICAgfSkudGhlbihmdW5jdGlvbiAocmVzKSB7CiAgICAgICAgcmV0dXJuIF90aGlzMi4kZW1pdCgnYWRkLVBvc3QnLCByZXMuZGF0YSk7CiAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uIChlcnJvcikgewogICAgICAgIHJldHVybiBjb25zb2xlLmxvZyhlcnJvcik7CiAgICAgIH0pOwogICAgICAvKiBvbiBlbWl0IGxlIHRvZ2dsZS1DcmVhdGUgcG91ciBjYWNoZXIgY2UgY29tcG9zYW50IHRvdXQgZW4gZWZmYcOnYW50IGxlcyBpbnB1dHMgKi8KCiAgICAgIHRoaXMuJGVtaXQoJ3RvZ2dsZS1DcmVhdGUnKTsKICAgICAgdGhpcy50ZXh0ID0gJyc7CiAgICAgIHRoaXMuZmlsZSA9ICcnOwogICAgICB0aGlzLnByZXZpZXcgPSAnJzsKICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcignZm9ybScpLnJlc2V0KCk7CiAgICB9CiAgfQp9Ow=="},{"version":3,"sources":["/Users/admin/Desktop/P7_ALICK_SOMAN/vue-frontend/src/components/CreatePost.vue"],"names":[],"mappings":"AAmBA,OAAO,KAAP,MAAkB,OAAlB;AACA,eAAe;AACX,EAAA,IAAI,EAAE,YADK;AAEX,EAAA,IAFW,kBAEJ;AACH,WAAO;AACH,MAAA,IAAI,EAAE,IADH;AAEH,MAAA,IAAI,EAAE,EAFH;AAGH,MAAA,OAAO,EAAE,IAHN;AAIH,MAAA,MAAM,EAAE;AAJL,KAAP;AAMH,GATU;AAUX,EAAA,OAAO,EAAE;AACL,IAAA,UADK,sBACM,KADN,EACa;AAAA;;AACd;AACA,WAAK,IAAL,GAAY,KAAK,KAAL,CAAW,IAAX,CAAgB,KAAhB,CAAsB,CAAtB,CAAZ;AACA,UAAI,KAAI,GAAI,KAAK,CAAC,MAAlB;;AACA,UAAG,KAAK,CAAC,KAAT,EAAgB;AACZ,YAAI,MAAK,GAAI,IAAI,UAAJ,EAAb;;AACA,QAAA,MAAM,CAAC,MAAP,GAAgB,UAAC,CAAD,EAAO;AACnB,UAAA,KAAI,CAAC,OAAL,GAAe,CAAC,CAAC,MAAF,CAAS,MAAxB;AACJ,SAFA;;AAGA,QAAA,MAAM,CAAC,aAAP,CAAqB,KAAK,CAAC,KAAN,CAAY,CAAZ,CAArB;AACJ;AACH,KAZI;AAaL,IAAA,UAbK,wBAaQ;AAAA;;AACT;AACA,UAAI,CAAC,KAAK,IAAV,EAAgB;AACZ,aAAK,MAAL,GAAc,qFAAd;AACA;AACJ;AACA;;;AACA,UAAI,QAAO,GAAI,IAAI,QAAJ,EAAf;AACA,MAAA,QAAQ,CAAC,MAAT,CAAgB,MAAhB,EAAwB,KAAK,IAA7B;AACA,MAAA,QAAQ,CAAC,MAAT,CAAgB,MAAhB,EAAwB,KAAK,IAA7B;AACA,MAAA,QAAQ,CAAC,MAAT,CAAgB,QAAhB,EAA0B,YAAY,CAAC,OAAb,CAAqB,QAArB,CAA1B;AACA;;AACA,MAAA,KAAK,CAAC,IAAN,CAAW,wCAAX,EAAqD,QAArD,EAA+D;AAC3D,QAAA,OAAO,EAAE;AACL,UAAA,aAAa,mBAAY,YAAY,CAAC,OAAb,CAAqB,OAArB,CAAZ;AADR;AADkD,OAA/D,EAKK,IALL,CAKU,UAAA,GAAE;AAAA,eAAK,MAAI,CAAC,KAAL,CAAW,UAAX,EAAuB,GAAG,CAAC,IAA3B,CAAL;AAAA,OALZ,EAMK,KANL,CAMW,UAAA,KAAI;AAAA,eAAK,OAAO,CAAC,GAAR,CAAY,KAAZ,CAAL;AAAA,OANf;AAOA;;AACA,WAAK,KAAL,CAAW,eAAX;AACA,WAAK,IAAL,GAAY,EAAZ;AACA,WAAK,IAAL,GAAY,EAAZ;AACA,WAAK,OAAL,GAAe,EAAf;AACA,MAAA,QAAQ,CAAC,aAAT,CAAuB,MAAvB,EAA+B,KAA/B;AACJ;AAtCK;AAVE,CAAf","sourcesContent":["<template>\n    <div id=\"createPost\">\n        <form @submit.prevent=\"createPost\">\n            <div id=\"text\">\n                <textarea name=\"textarea\" placeholder=\"Publiez votre message\" v-model=\"text\"></textarea>\n            </div>\n            <div id=\"preview\" v-if=\"preview\">\n                <img :src=\"preview\" :alt=\"preview\">\n            </div>         \n            <div id=\"btns\">                \n                <input type=\"file\" ref=\"file\" name=\"file\" class=\"upload\" id=\"file\" @change=\"selectFile\">             \n                <input type=\"submit\" value=\"J'envoie !\" class=\"btn\">\n            </div>\n            <p>{{errMsg}}</p>\n        </form>\n    </div>\n</template>\n\n<script>\nimport axios from 'axios';\nexport default {\n    name: 'CreatePost',\n    data() {\n        return {\n            text: null,\n            file: '',\n            preview: null,\n            errMsg: null\n        }\n    },\n    methods: {\n        selectFile(event) {\n            /* sur le onchange on va attribuer cette valeur à file (nécessaire pour l'envoi au backend) */\n            this.file = this.$refs.file.files[0]\n            let input = event.target\n            if(input.files) {\n                let reader = new FileReader()\n                reader.onload = (e) => {\n                    this.preview = e.target.result\n                }\n                reader.readAsDataURL(input.files[0])\n            }\n        },\n        createPost() {\n            /* on peut envoyer un post sans image mais il faut au moins qu'il y est un texte */     \n            if (!this.text) {\n                this.errMsg = \"Error => vous devez remplir le champ <message> pour créer une nouvelle publication!\"\n                return\n            }\n            /* on créé un objet formData afin de pouvoir ajouter le texte et surtout le file choisi */\n            let formData = new FormData()\n            formData.append('text', this.text)\n            formData.append('file', this.file)\n            formData.append('userId', localStorage.getItem('userId'))\n            /* envoi du form via axios.put de l'objet formData */\n            axios.post('http://localhost:3000/api/posts/create', formData, {\n                headers: {\n                    Authorization: `Bearer ${localStorage.getItem('token')}`\n                },\n            })  \n                .then(res => this.$emit('add-Post', res.data))\n                .catch(error => console.log(error))\n            /* on emit le toggle-Create pour cacher ce composant tout en effaçant les inputs */\n            this.$emit('toggle-Create')\n            this.text = ''\n            this.file = ''\n            this.preview = ''\n            document.querySelector('form').reset()           \n        }\n    }\n}\n</script>\n\n<style scoped>\n#createPost {\n    max-width: 60%;\n    box-shadow: 2px 2px 8px 5px rgb(0 0 0 / 10%);\n    margin: auto;\n    margin-top: 2rem;\n    padding: 1rem;\n    border-radius: 4px;\n}\nform {\n    display: flex;\n    flex-direction: column;\n}\ntextarea {\n    height: 5rem;\n    padding: 1rem 0 0 1rem;\n    width: calc(100% - 1rem)\n}\n#preview {\n    overflow: hidden;\n    max-width: 20%;\n}\nimg {\n    height: 100%;\n    width: 100%;\n    object-fit: cover;\n}\n#btns {\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    margin-top: 1rem;\n    border-top: 1px solid hsla(0, 0%, 0%, 0.5);\n    padding-top: 2rem;\n}\n.btn {\n    background-color: #1c68e6;\n    border-style: none;\n    outline: none;\n    width: 20%;\n    border-radius: 8px;\n    height: 40px;\n    color: white;\n}\n.upload:active {\n  transform: scale(0.98);\n}\np {\n    margin-top: 1.6rem;\n}\n@media screen and (max-width: 992px) {\n    #createPost {\n        max-width: 90%;\n    }\n}\n</style>"],"sourceRoot":""}]}