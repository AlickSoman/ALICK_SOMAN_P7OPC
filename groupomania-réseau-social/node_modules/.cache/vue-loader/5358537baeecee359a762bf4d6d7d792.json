{"remainingRequest":"/Users/admin/Desktop/P7_ALICK_SOMAN/vue-frontend/node_modules/vue-loader-v16/dist/index.js??ref--0-1!/Users/admin/Desktop/P7_ALICK_SOMAN/vue-frontend/src/components/ModifyPost.vue?vue&type=template&id=0d9e34ac&scoped=true","dependencies":[{"path":"/Users/admin/Desktop/P7_ALICK_SOMAN/vue-frontend/src/components/ModifyPost.vue","mtime":1631120511000},{"path":"/Users/admin/Desktop/P7_ALICK_SOMAN/vue-frontend/node_modules/cache-loader/dist/cjs.js","mtime":1646670308046},{"path":"/Users/admin/Desktop/P7_ALICK_SOMAN/vue-frontend/node_modules/babel-loader/lib/index.js","mtime":1646670309179},{"path":"/Users/admin/Desktop/P7_ALICK_SOMAN/vue-frontend/node_modules/vue-loader-v16/dist/templateLoader.js","mtime":1646670310149},{"path":"/Users/admin/Desktop/P7_ALICK_SOMAN/vue-frontend/node_modules/cache-loader/dist/cjs.js","mtime":1646670308046},{"path":"/Users/admin/Desktop/P7_ALICK_SOMAN/vue-frontend/node_modules/vue-loader-v16/dist/index.js","mtime":1646670309571}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CiAgICA8ZGl2IGlkPSJtb2RpZnlQb3N0Ij4KICAgICAgICA8Zm9ybSBAc3VibWl0LnByZXZlbnQ9Im1vZGlmeVBvc3QiPgogICAgICAgICAgICA8ZGl2IGlkPSJidG5zIj4KICAgICAgICAgICAgICAgIDxsYWJlbCBmb3I9ImZpbGUiPkNob2lzaXIgdW5lIG5vdXZlbGxlIGltYWdlPC9sYWJlbD4KICAgICAgICAgICAgICAgIDxpbnB1dCB0eXBlPSJmaWxlIiByZWY9ImZpbGUiIG5hbWU9ImZpbGUiIGNsYXNzPSJ1cGxvYWQiIGlkPSJmaWxlIiBAY2hhbmdlPSJ1cGRhdGVGaWxlIj4KICAgICAgICAgICAgPC9kaXY+CiAgICAgICAgICAgIDxkaXYgaWQ9ImZpbGVDb250YWluZXIiPgogICAgICAgICAgICAgICAgPGltZyBpZD0icHJldmlldyIgOnNyYz0iJ2h0dHA6Ly9sb2NhbGhvc3Q6MzAwMC9pbWFnZXMvJyArIHBvc3QuZmlsZSIgOmFsdD0icG9zdC5maWxlIiB2LWlmPSJwcmV2aWV3Ij4KICAgICAgICAgICAgICAgIDxwIHYtZWxzZT5DZSBwb3N0IG5lIHBvc3PDqGRlIHBhcyBkJ2ltYWdlPC9wPgogICAgICAgICAgICA8L2Rpdj4KICAgICAgICAgICAgPGRpdiBpZD0idGV4dCI+CiAgICAgICAgICAgICAgICA8bGFiZWwgZm9yPSJ0ZXh0YXJlYSI+Q2hhbmdlciB2b3RyZSB0ZXh0ZTwvbGFiZWw+CiAgICAgICAgICAgICAgICA8dGV4dGFyZWEgbmFtZT0idGV4dGFyZWEiIHYtbW9kZWw9InBvc3QudGV4dCI+PC90ZXh0YXJlYT4KICAgICAgICAgICAgPC9kaXY+CiAgICAgICAgICAgIDxkaXYgaWQ9Im1vZGlmeSI+CiAgICAgICAgICAgICAgICA8aW5wdXQgdHlwZT0ic3VibWl0IiB2YWx1ZT0iamUgbW9kaWZpZSAhIiBjbGFzcz0iYnRuIj4gICAgCiAgICAgICAgICAgIDwvZGl2PgogICAgICAgICAgICA8cD57e2Vyck1zZ319PC9wPgogICAgICAgIDwvZm9ybT4KICAgIDwvZGl2Pgo="},{"version":3,"sources":["/Users/admin/Desktop/P7_ALICK_SOMAN/vue-frontend/src/components/ModifyPost.vue"],"names":[],"mappings":"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","file":"/Users/admin/Desktop/P7_ALICK_SOMAN/vue-frontend/src/components/ModifyPost.vue","sourceRoot":"","sourcesContent":["<template>\n    <div id=\"modifyPost\">\n        <form @submit.prevent=\"modifyPost\">\n            <div id=\"btns\">\n                <label for=\"file\">Choisir une nouvelle image</label>\n                <input type=\"file\" ref=\"file\" name=\"file\" class=\"upload\" id=\"file\" @change=\"updateFile\">\n            </div>\n            <div id=\"fileContainer\">\n                <img id=\"preview\" :src=\"'http://localhost:3000/images/' + post.file\" :alt=\"post.file\" v-if=\"preview\">\n                <p v-else>Ce post ne possède pas d'image</p>\n            </div>\n            <div id=\"text\">\n                <label for=\"textarea\">Changer votre texte</label>\n                <textarea name=\"textarea\" v-model=\"post.text\"></textarea>\n            </div>\n            <div id=\"modify\">\n                <input type=\"submit\" value=\"je modifie !\" class=\"btn\">    \n            </div>\n            <p>{{errMsg}}</p>\n        </form>\n    </div>\n</template>\n\n<script>\nimport axios from 'axios';\nimport router from '../router'\nexport default {\n    name: 'ModifyPost',\n    beforeCreate() {\n        /* on récupère l'id du post via l'url */\n        const parsedUrl = new URL(window.location.href)\n        const postId = parsedUrl.pathname.split('/modify-post/')[1]\n        /* selon l'id on récupère le post concerné */\n        fetch(`http://localhost:3000/api/posts/${postId}`, {\n            headers: {\n                Authorization: `Bearer ${localStorage.getItem('token')}`\n            }\n        })\n            .then(res => res.json())\n            .then(data => {\n                data.file ? this.preview = true : this.preview = false\n                this.post = {...data}\n            })\n            .catch(error => {error})\n    },\n    data() {\n        return {\n            post: {},\n            newFile: '',\n            preview: null,\n            errMsg: null\n        }\n    },\n    methods: {\n        updateFile(event) {\n            /* sur le onchange on va attribuer cette valeur à file (nécessaire pour l'envoi au backend) */ \n            this.newFile = this.$refs.file.files[0]\n            let input = event.target\n            if(input.files) {\n                let reader = new FileReader()\n                reader.onload = (e) => {\n                    document.getElementById('preview').src = e.target.result\n                }\n                reader.readAsDataURL(input.files[0])\n                this.preview = true\n            }\n        },\n        async modifyPost() {\n            /* on peut envoyer un post sans image mais il faut au moins qu'il y est un texte */     \n            if (!this.post.text) {\n                this.errMsg = \"Error => vous devez remplir le champ <message> pour créer une nouvelle publication!\"\n                return\n            }\n            /* on créé un objet formData afin de pouvoir ajouter le texte et surtout le file choisi */\n            let formData = new FormData()\n            formData.append('text', this.post.text)\n            if (this.newFile) {\n                formData.append('file', this.newFile)\n            }\n            /* envoi du form via axios.put de l'objet formData */\n            if (confirm(\"êtes vous sûr de vouloir modifier votre post ?\")) {\n                axios.put(`http://localhost:3000/api/posts/${this.post.id}`, formData, {\n                    headers: {\n                        Authorization: `Bearer ${localStorage.getItem('token')}`\n                    },\n                })  \n                    .then(res => {\n                        console.log(res.data)\n                        router.push({ path: '/home' })                                               \n                    })\n                    .catch(error => console.log(error))\n            }            \n        }\n    }\n}\n</script>\n\n<style scoped>\n#modifyPost {\n    max-width: 60%;\n    box-shadow: 2px 2px 8px 5px rgb(0 0 0 / 10%);\n    margin: auto;\n    margin-top: 2rem;\n    padding: 1rem;\n    border-radius: 4px;\n}\nform {\n    display: flex;\n    flex-direction: column;\n}\n#fileContainer {\n    overflow: hidden;\n    margin: 1rem 0 1rem 0;\n}\nimg {\n    height: 100%;\n    width: 100%;\n    object-fit: cover;\n}\n#btns {\n    display: flex;\n    flex-direction: column;\n}\n#file {\n    cursor: pointer;\n}\n#text {\n    display: flex;\n    flex-direction: column;\n}\nlabel {\n    margin: 1rem;\n    padding: 0.5rem 0;\n    text-align: center;\n    border-radius: 8px;\n    box-shadow: 2px 2px 8px 5px rgb(0 0 0 / 10%);\n}\ntextarea {\n    padding: 16px;\n}\n#modify {\n    text-align: right;\n}\n.btn {\n    background-color: #1c68e6;\n    border-style: none;\n    outline: none;\n    width: 20%;\n    border-radius: 8px;\n    height: 40px;\n    color: white;\n    margin: 1rem 0 1rem 0;\n}\n@media screen and (max-width: 992px) {\n    #modifyPost {\n        max-width: 90%;\n    }\n}\n</style>"]}]}